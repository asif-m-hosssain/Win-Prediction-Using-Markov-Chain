---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
library(dplyr)
library(data.table)
library(markovchain)
library(diagram)
library(expm)
library(pracma)
library(ggplot2)
```

Importing CSV

```{r}
team=read.csv("matches.csv",header=TRUE,sep=",")
class(team)
team
```
Data preprocessing
```{r}
unique(team[c("home_team")])
arg=subset(team, home_team == "Argentina")
arg
arg_res=arg[c("home_team","home_team_result")]
arg_res
unique(arg_res[c("home_team_result")])

arg_wc = arg_res=arg[c("home_team","home_team_result")]
```

Result isolation
```{r}
result = arg_res[c("home_team_result")]
result
class(result)
```

State & State Transitions
```{r}
wtw=0
wtl=0
wtd=0

ltl=0
ltw=0
ltd=0

dtd=0
dtw=0
dtl=0
```
rough
```{r}
len = lengths(result)-1
len
result[189,]
```


Counting state transitions
```{r}
for (i in 1:len){
  if (result[i,] == "Win"){
    if(result[i+1,] == "Win"){
      wtw= wtw + 1
    }
    else if(result[i+1,] == "Lose"){
      wtl= wtl + 1
    }
    else{
      wtd = wtd + 1
    }
  }
  
  else if (result[i,] == "Lose"){
    if(result[i+1,] == "Lose"){
      ltl= ltl + 1
    }
    else if(result[i+1,] == "Win"){
      ltw= ltw + 1
    }
    else{
      ltd = ltd + 1
    }
  }
  
  else if (result[i,] == "Draw"){
    if(result[i+1,] == "Draw"){
      dtd= dtd + 1
    }
    else if(result[i+1,] == "Win"){
      dtw= dtw + 1
    }
    else{
      dtl = dtl + 1
    }
  }
}

```
result check
```{r}
wtw
wtl
wtd

ltl
ltw
ltd

dtd
dtw
dtl
```
Number of occurances
```{r}
table(result$home_team_result)
count(filter(result,home_team_result=="Win"))
count(filter(result,home_team_result=="Lose"))
count(filter(result,home_team_result=="Draw"))

wt = wtw+wtl+wtd
lt = ltl+ltw+ltd
dt = dtd+dtw+dtl
```
Transitional Probability
```{r}
tp_wtw = wtw/wt
tp_wtl = wtl/wt
tp_wtd = wtd/wt

tp_ltl = ltl/lt
tp_ltw = ltw/lt
tp_ltd = ltd/lt

tp_dtd = dtd/dt
tp_dtw = dtw/dt
tp_dtl = dtl/dt

tp_wtw 
tp_wtl 
tp_wtd 

tp_ltl 
tp_ltw 
tp_ltd 

tp_dtd 
tp_dtw 
tp_dtl 
```
Transitional Matrix
```{r}
tm_result<- round(matrix(c(tp_wtw,tp_wtl,tp_wtd,
                           tp_ltl,tp_ltw,tp_ltd,
                           tp_dtd,tp_dtw,tp_dtl),nrow = 3, byrow = TRUE),3)

states = c("Win","Loss","Draw")
row.names(tm_result) <- states 
colnames(tm_result) = states
tm_result
```
```{r}
transition_matrix_result <- new("markovchain",transitionMatrix=tm_result, 
             states=c("Win","Loss","Draw"),
             name="MarkovChain for Argentina Game Result Prediction") 
```

